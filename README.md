<h1 align="center">üöí Accident Detector üöí</h1>
<p align="center">  
 
<img src="https://gpvc.arturio.dev/Vanna-Ivision-2-0">

<img src="https://img.shields.io/badge/made%20by-Vanna-violet.svg" >

<img src="https://img.shields.io/badge/python-3.9 -red.svg">

<img src="https://badges.frapsoft.com/os/v1/open-source.svg?v=103" >

<img src="https://img.shields.io/github/contributors/Vanna-Ivision-2-0/Vanna_Ivision_2_0.svg" >

<img src="https://img.shields.io/github/stars/Vanna-Ivision-2-0/Vanna_Ivision_2_0.svg?style=flat">

<img src="https://img.shields.io/github/languages/top/Vanna-Ivision-2-0/Vanna_Ivision_2_0.svg">

<img src="https://img.shields.io/github/issues/Vanna-Ivision-2-0/Vanna_Ivision_2_0.svg">

<img src="https://img.shields.io/github/watchers/Vanna-Ivision-2-0/Vanna_Ivision_2_0.svg?style=social&label=Watch&maxAge=2592000">

</p>

<p align="center"><img  src="./readme_assets/logo_proj1.png" width="30%"></p>

## ***–ù–∞–≤–∏–≥–∞—Ü–∏—è***
- [–û–ø–∏—Å–∞–Ω–∏–µ](#–æ–ø–∏—Å–∞–Ω–∏–µ)
- [–ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –ø—Ä–æ–≥—Ä–∞–º–º–æ–π](#–∫–∞–∫_–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è)
- [–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?](#–∫–∞–∫_—ç—Ç–æ_—Ä–∞–±–æ—Ç–∞–µ—Ç)
- [–û –ø—Ä–æ–µ–∫—Ç–µ –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è—Ö](#–æ_–ø—Ä–æ–µ–∫—Ç–µ_–∏_—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è—Ö)
  - [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
  - [–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏](#—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ_–º–æ–¥–µ–ª–∏)
  - [Computer Vision & Machine Learning](#computer_vision_and_machine_learning)
  - [–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏](#–æ–±—É—á–µ–Ω–∏–µ_–º–æ–¥–µ–ª–∏)
  - ["–ü–æ–¥–≤–æ–¥–Ω—ã–µ –∫–∞–º–Ω–∏"](#–ø–æ–¥–≤–æ–¥–Ω—ã–µ_–∫–∞–º–Ω–∏)
- [Installation](#installation)
- [–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã](#–ø—Ä–æ–±–ª–µ–º—ã)

<a name="–æ–ø–∏—Å–∞–Ω–∏–µ"></a> 
## ***–û–ø–∏—Å–∞–Ω–∏–µ***

–ü—Ä–æ–≥—Ä–∞–º–º–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –î–¢–ü –∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–π —Ç–µ—Ö–Ω–∏–∫–∏ –Ω–∞ –≤–∏–¥–µ–æ–∑–∞–ø–∏—Å—è—Ö —Å –∫–∞–º–µ—Ä –Ω–∞—Ä—É–∂–Ω–æ–≥–æ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è. –í–æ–∑–º–æ–∂–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≤ "real-time" (–æ–Ω–ª–∞–π–Ω —Ä–µ–∂–∏–º).
–° —Ç–∞–∫–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–º–æ–∂–µ—Ç –∑–∞—Ä–∞–Ω–µ–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏—Ç—É–∞—Ü–∏—é –Ω–∞ –¥–æ—Ä–æ–≥–∞—Ö, –ø—Ä–∏—á–∏–Ω—É –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è "–ø—Ä–æ–±–∫–∏" –∏ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –¥–ª—è —Å–µ–±—è —É–¥–æ–±–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –º–∞—Ä—à—Ä—É—Ç–∞.

<a name="–∫–∞–∫_–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è"></a> 
## ***–ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –ø—Ä–æ–≥—Ä–∞–º–º–æ–π***

1) –ü–æ–º–µ—â–∞–µ–º –≤–∏–¥–µ–æ –≤ –ø–∞–ø–∫—É videos.
<p align="left">
<img src="./readme_assets/1.jpg" width="40%"></p>

2) –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞–µ–º –≤–∏–¥–µ–æ –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–¥–æ—Å—Ç—É–ø–µ–Ω Progress Bar).
<p align="left">
<img src="./readme_assets/2.jpg" width="60%"></p>

3) –ó–∞–ø—É—Å–∫ –¥–µ—Ç–µ–∫—Ç–æ—Ä–∞ –æ–±—ä–µ–∫—Ç–æ–≤ –¥–ª—è –≤—Å–µ—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –∏–∑ videos2images 
<p align="left">
<img src="./readme_assets/3.jpg" width="60%"></p>

4) –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞–±–æ—Ç—ã –¥–µ—Ç–µ–∫—Ç–æ—Ä–∞ –æ–±—ä–µ–∫—Ç–æ–≤
<p align="left">
<img src="./readme_assets/4.jpg" width="60%"></p>

<p align="left">
<img src="./readme_assets/5.jpg" width="60%"></p>

<a name="–∫–∞–∫_—ç—Ç–æ_—Ä–∞–±–æ—Ç–∞–µ—Ç"></a> 
## ***–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?***

–ò–∑–Ω–∞—á–∞–ª—å–Ω–æ, –≤—Å–µ –≤–∏–¥–µ–æ—Ñ–∞–π–ª—ã –∏–∑ –ø–∞–ø–∫–∏ videos –ø—Ä–µ–æ–±—Ä–∞–∑—É—é—Ç—Å—è –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫–∞–¥—Ä–æ–≤. 
–ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã–π —Ä–∞—Å—á—ë—Ç –Ω–∞ —Ç–æ, —á—Ç–æ fps —É —Ç–µ—Å—Ç–æ–≤—ã—Ö –≤–∏–¥–µ–æ –±—É–¥–µ—Ç —Ç–∞–∫–æ–π –∂–µ, –∫–∞–∫ –∏ —É —Ç–µ—Ö, —á—Ç–æ –±—ã–ª–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω—ã –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ, —Ç.–µ. 30. 
- –ò–∑ –≤–∏–¥–µ–æ –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É –±–µ—Ä—ë—Ç—Å—è 2 –∫–∞–¥—Ä–∞. 
- –ó–∞—Ç–µ–º –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∫–∞–¥—Ä–æ–≤ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –¥–µ—Ç–µ–∫—Ç–æ—Ä–æ–º –æ–±—ä–µ–∫—Ç–æ–≤ —Å –ø–æ—Ä–æ–≥–æ–º —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ 0.7. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –≤ –ø–∞–ø–∫–µ detection_results –¥–ª—è –≤—Å–µ—Ö –≤–∏–¥–µ–æ—Ñ–∞–π–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–ª–∏—Å—å –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫–∞–¥—Ä–æ–≤, –ø–æ—è–≤—è—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞–±–æ—Ç—ã –¥–µ—Ç–µ–∫—Ç–æ—Ä–∞ –æ–±—ä–µ–∫—Ç–æ–≤. –í –ø–∞–ø–∫–µ labels –≤ –∫–∞–∂–¥–æ–º —Ñ–∞–π–ª–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–µ—Å—Ç–æ–Ω–∞—Ö–æ–∂–¥–µ–Ω–∏–∏ –æ–±—ä–µ–∫—Ç–∞ (bouning box) + —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å (confidence).  
- –õ–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –î–¢–ü –∑–∞–∫–ª—é—á–µ–Ω–∞ –≤ dtp.py. –ú—ã —Å—á–∏—Ç–∞–µ–º, —á—Ç–æ –î–¢–ü —Å–ª—É—á–∏–ª–æ—Å—å –≤ —Ç–æ–º —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ –Ω–∞ –º–∏–Ω–∏–º—É–º 10 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –±—ã–ª –Ω–∞–π–¥–µ–Ω —Å–ø–µ—Ü—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç —Å —É–≤–µ—Ä–µ–Ω–æ—Å—Ç—å—é –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏ >=0.7. –í —Å–ª—É—á–∞–µ –Ω–∞—Å—Ç—É–ø–ª–µ–Ω–∏—è –î–¢–ü, –≤ –ø–∞–ø–∫–µ proof –ø–æ—è–≤–∏—Ç—Å—è –≤–∏–¥–µ–æ—Ñ–∞–π–ª, –∞ —Ç–∞–∫–∂–µ –≤ –∫–æ–Ω—Å–æ–ª—å –±—É–¥–µ—Ç –≤—ã–≤–µ–¥–µ–Ω–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ.

<a name="–æ_–ø—Ä–æ–µ–∫—Ç–µ_–∏_—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è—Ö"></a> 
## ***–û –ø—Ä–æ–µ–∫—Ç–µ –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è—Ö***

<a name="–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞"></a> 
### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

<p align="left">
<img src="./readme_assets/Architecture.jpg" width="30%"></p> 

<a name="—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ_–º–æ–¥–µ–ª–∏"></a> 
### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏

<a name="computer_vision_and_machine_learning"></a> 
### Computer Vision & Machine Learning

**–¢–µ—Ö–Ω–æ–Ω–æ–ª–æ–≥–∏–∏**:
- [OpenCV](https://opencv.org/)
- [ffmpeg](https://www.ffmpeg.org/)
- [PyTorch](https://pytorch.org/)
- [YOLOv5](https://github.com/ultralytics/yolov5)
- [WandDB](https://wandb.ai/site)
- [Roboflow](https://roboflow.com/)

<a name="–æ–±—É—á–µ–Ω–∏–µ_–º–æ–¥–µ–ª–∏"></a> 
### –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

*–ú–µ—Ç—Ä–∏–∫–∏ –æ—Ü–µ–Ω–∏–≤–∞–Ω–∏—è:*
<p align="left">
<img src="./readme_assets/–º–µ—Ç—Ä–∏–∫–∏ –æ—Ü–µ–Ω–∏–≤–∞–Ω–∏—è.jpg" width="60%"></p> 

–∞  |  –±
:-------------------------:|:-------------------------:
![](https://github.com/Vanna-Ivision-2-0/Vanna_Ivision_2_0/tree/main/readme_assets/precconf.jpg)  |  ![](https://github.com/Vanna-Ivision-2-0/Vanna_Ivision_2_0/tree/main/readme_assets/recallconf.jpg)
![](https://github.com/Vanna-Ivision-2-0/Vanna_Ivision_2_0/tree/main/readme_assets/F1conf.jpg)  |  ![](https://github.com/Vanna-Ivision-2-0/Vanna_Ivision_2_0/tree/main/readme_assets/precrec.jpg)

*–î–µ—Ç–µ–∫—Ü–∏—è –æ–±—ä–µ–∫—Ç–æ–≤:*
–î–µ—Ç–µ–∫—Ü–∏—è —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é    |  –î–µ—Ç–µ–∫—Ü–∏—è –±–µ–∑ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏
:-------------------------:|:-------------------------:
![](https://github.com/Vanna-Ivision-2-0/Vanna_Ivision_2_0/tree/main/readme_assets/detection.jpg)  |  ![](https://github.com/Vanna-Ivision-2-0/Vanna_Ivision_2_0/tree/main/readme_assets/detectionwithoutnumbers.jpg)

*Train metrics:*
<p align="left">
<img src="./readme_assets/trainmetrix.jpg" width="60%"></p>

Confusion Matrix:
<p align="left">
<img src="./readme_assets/confusionmatrix.jpg" width="60%"></p>



<a name="–ø–æ–¥–≤–æ–¥–Ω—ã–µ_–∫–∞–º–Ω–∏"></a> 
### ***–ü–æ–¥–≤–æ–¥–Ω—ã–µ –∫–∞–º–Ω–∏***

<a name="installation"></a> 
## ***Installation***

- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞–∫–µ—Ç—ã –∏–∑ requirements.txt:

  `pip install ‚Äìr requirements.txt`
- –°–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª—ã –º–æ–¥–µ–ª–µ–π –ø–æ [—Å—Å—ã–ª–∫–µ] (https://drive.google.com/drive/folders/1SnG5JwYExb_aabh7PZWeJ14M50yia6uv?usp=sharing)
- –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –∏—Ö –≤ weights

<a name="–ø—Ä–æ–±–ª–µ–º—ã"></a> 
## ***–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã***

–í —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ –∞–ª–≥–æ—Ä–∏—Ç–º –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–∏–ª –î–¢–ü, –≤–æ–∑–º–æ–∂–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è:
- –£–≤–µ–ª–∏—á–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –ø—Ä–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–∏ –∏–∑ –≤–∏–¥–µ–æ –≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è. 
python videos2imgs.py  --when 5
–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω –∫–∞–∂–¥—ã–π 5-—ã–π –∫–∞–¥—Ä, –º—ã —É–≤–µ–ª–∏—á–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –ø–∞–ø–∫–∞—Ö –≤—Ç—Ä–æ–µ. –ü–æ–≤—Ç–æ—Ä–∏—Ç—å —à–∞–≥–∏, –Ω–∞—á–∏–Ω–∞—è —Å detect.
- –ï—Å–ª–∏ —Ä–æ–ª–∏–∫–∏ –∫–æ—Ä–æ—Ç–∫–∏–µ –∏ –Ω–µ –ø—Ä–∏–º–µ–Ω—è–ª–∏ —à–∞–≥ –≤—ã—à–µ, —Ç–æ —Å–ª–µ–¥—É–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä --thresh –¥–ª—è is_dtp.py –Ω–∞ 7 –∏–ª–∏ 5.
python is_dtp.py --thresh 7
- –ï—Å–ª–∏ —ç—Ç–æ –Ω–µ –ø–æ–º–æ–≥–ª–æ, —Ç–æ –∏–∑–º–µ–Ω—è–µ–º confidence threshold –¥–ª—è –¥–µ—Ç–µ–∫—Ç–æ—Ä–∞ –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ 0.6
python detect.py  --conf-thres 0.6
–¢–µ–ø–µ—Ä—å python is_dtp.py --thresh 7 --conf 0.6
- –í —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –ª–æ–∂–Ω—ã–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è, —Ç–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã --thresh –¥–æ 15-20 –∏–ª–∏
 --conf –¥–æ 0.75-0.85.
